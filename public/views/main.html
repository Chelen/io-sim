<div class="container">
    <div class="row">
        <div class="col-lg-12 text-center">
            <a class="glyphicon glyphicon-arrow-left left-positioned text-primary animate-hide"
               aria-hidden="true" ng-click="mainCtrl.reset()" ng-show="!mainCtrl.editing && !mainCtrl.loading"></a>
            <h2 class="section-heading">Simulation</h2>
            <hr class="primary">
        </div>
    </div>
</div>

<div class="alert alert-warning alert-dismissible fade top-positioned" role="alert" ng-class="mainCtrl.error ? 'in' : ''">
    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">Ã—</span></button>
    <strong>Holy guacamole!</strong> Best check yo self, you're not looking too good.
</div>

<div class="row text-center animate-hide" ng-show="mainCtrl.loading">
    <img src="/assets/images/hex-loader.gif" >
</div>

<div class="container animate-hide" ng-show="mainCtrl.editing" name="simForm" ng-class="!mainCtrl.editing ? 'no-transition' : 'delay-transition'">
    <form ng-submit="mainCtrl.submit()" ng-disabled="simForm.$invalid">
        <div class="row">
            <div class="form-group col-sm-4">
                <label for="priority"> Priority</label>
                <select class="form-control" id="priority" ng-model="mainCtrl.simulation.priority" ng-change="mainCtrl.selectSim()">
                    <option>Total</option>
                    <option>Relative</option>
                </select>
            </div>
            <div class="form-group col-sm-4">
                <label for="tolerance"> Tolerance</label>
                <select class="form-control" id="tolerance" ng-model="mainCtrl.simulation.tolerance" ng-change="mainCtrl.selectSim()">
                    <option>Tolerant</option>
                    <option>Intolerant</option>
                </select>
            </div>
            <div class="form-group col-sm-4" ng-show="mainCtrl.simulation.tolerance == 'Tolerant'">
                <label for="reanudacion"> Resumption</label>
                <select class="form-control" id="reanudacion" ng-model="mainCtrl.simulation.resumption" ng-change="mainCtrl.selectSim()">
                    <option>Resumption</option>
                    <option>Reinitiation</option>
                </select>
            </div>
            <div class="form-group col-sm-4" ng-show="mainCtrl.simulation.tolerance == 'Intolerant'">
                <label for="intolerance"> Intolerance</label>
                <select class="form-control" id="intolerance" ng-model="mainCtrl.simulation.intolerance" ng-change="mainCtrl.selectSim()">
                    <option>Partial</option>
                    <option>Total</option>
                </select>
            </div>
            </div>

        <pre>{{mainCtrl.simulation | json}}</pre>
        <div class="row">
            <div class="form-group col-sm-6">
                <label for="time">Time</label>
                <!--<input type="number" class="form-control" id="time" placeholder="Time" ng-model="mainCtrl.formData.simData.time">-->
                <rzslider id="time"
                        rz-slider-floor="0"
                        rz-slider-ceil="mainCtrl.formData.simData.withEvents ? 20 : 10000"
                        rz-slider-model="mainCtrl.formData.simData.time"></rzslider>
                <p class="help-block small-help" ng-show="mainCtrl.formData.simData.time > 5000">May take up to 5 min.</p>

            </div>

            <div class="form-group col-sm-6">
                <div class="checkbox">
                    <label>
                        <input type="checkbox" ng-model="mainCtrl.formData.simData.withEvents"
                                ng-change="mainCtrl.eventsToggle()">
                        Show Table & Graphs </label>
                    <p class="help-block small-help">Shows all events and graphs statistics. Requires time < 20.</p>

                </div>
            </div>
        </div>

        <pre>{{mainCtrl.formData.simData}}</pre>
        <div class="row">
            <div class="form-group col-sm-6">
                <label for="cliA">Clients <strong>A</strong> Per Hour</label>
                <input type="number" class="form-control" id="cliA" placeholder="Rate" ng-model="mainCtrl.formData.simData.clientsHourA">
            </div>
            <div class="form-group col-sm-6">
                <label for="cliB">Clients <strong>B</strong> Per Hour</label>
                <input type="number" class="form-control" id="cliB" placeholder="Rate" ng-model="mainCtrl.formData.simData.clientsHourB">
            </div>
        </div>

        <div class="row">
            <div class="form-group col-sm-6">
                <label for="muA">Attention <strong>A</strong> Per Hour</label>
                <input type="number" class="form-control" id="muA" placeholder="Rate" ng-model="mainCtrl.formData.simData.muA">
            </div>
            <div class="form-group col-sm-6">
                <label for="muB">Attention <strong>B</strong> Per Hour</label>
                <input type="number" class="form-control" id="muB" placeholder="Rate" ng-model="mainCtrl.formData.simData.muB">
            </div>
        </div>

        <!--<a class="btn" type="button" data-toggle="collapse" data-target="#advanced" aria-expanded="false" aria-controls="collapseExample"> Advanced Options </a>-->

        <div class="row text-center">
            <input type="submit" class="btn btn-default btn-xl" value="Submit"/>
        </div>
    </form>
    <p> Simulation by :  {{mainCtrl.simulation.name | json}} </p>
</div>

<div class="container animate-hide" ng-show="!mainCtrl.editing && !mainCtrl.loading"  ng-class="!mainCtrl.editing ? 'delay-transition' : 'no-transition' " >
    <div class="row">

        <!--mainCtrl.items.results-->
        <div class="col-sm-4 text-center">
            <h2 class="section-heading text-primary">A</h2>

            <div class="service-box">
                <h3>{{ mainCtrl.items.results.acustomers}}</h3>
                <p class="text-muted">Total</p>
            </div>

            <div class="service-box">
                <div class="progress">
                    <div class="progress-bar progress-bar-success" style="width:{{mainCtrl.items.results.ha | percentage:3}}">
                        {{mainCtrl.items.results.ha | percentage:3}}
                    </div>
                </div>
                <p class="text-muted">Porcentaje Atencion</p>
            </div>

            <div class="service-box">
                <div class="col-md-6">
                    <h3>{{ mainCtrl.items.results.lcA | number:8}}</h3>
                    <p class="text-muted">Longitud Cola</p>
                </div>

                <div class="col-md-6">
                    <h3>{{ mainCtrl.items.results.la | number:8}}</h3>
                    <p class="text-muted">Longitud Sistema</p>
                </div>
            </div>

            <div class="service-box">
                <div class="col-md-6">
                    <h3>{{ mainCtrl.items.results.wcA | number:8}}</h3>
                    <p class="text-muted">Tiempo Espera</p>
                </div>

                <div class="col-md-6">
                    <h3>{{ mainCtrl.items.results.wa | number:8}}</h3>
                    <p class="text-muted">Tiempo Permanencia</p>
                </div>
            </div>


        </div>

        <div class="col-sm-4 text-center">
            <h2 class="section-heading text-primary">B</h2>

            <div class="service-box">
                <h3>{{ mainCtrl.items.results.bcustomers}}</h3>
                <p class="text-muted">Total</p>
            </div>

            <div class="service-box">
                <div class="progress">
                    <div class="progress-bar progress-bar-success" style="width:{{mainCtrl.items.results.hb | percentage:3}}">
                        {{mainCtrl.items.results.hb | percentage:3}}
                    </div>
                    <div class="progress-bar progress-bar-warning" style="width:{{mainCtrl.items.results.porcentajeBNoIngresa | percentage:3}}">
                        {{mainCtrl.items.results.porcentajeBNoIngresa | percentage:3}}
                    </div>
                    <div class="progress-bar progress-bar-danger" style="width:{{mainCtrl.items.results.porcentajeBAbandono | percentage:3}}">
                        {{mainCtrl.items.results.porcentajeBAbandono | percentage:3}}
                    </div>
                </div>
                <p class="text-muted">Porcentaje <span class="text-success">Atencion</span>, <span class="text-warning">No Ingreso</span>, <span class="text-danger">Abandono</span></p>
            </div>

            <div class="service-box">
                <div class="col-md-6">
                    <h3>{{ mainCtrl.items.results.lcB | number:8}}</h3>
                    <p class="text-muted">Longitud Cola</p>
                </div>

                <div class="col-md-6">
                    <h3>{{ mainCtrl.items.results.lb | number:8}}</h3>
                    <p class="text-muted">Longitud Sistema</p>
                </div>
            </div>

            <div class="service-box">
                <div class="col-md-6">
                    <h3>{{ mainCtrl.items.results.wcB | number:8}}</h3>
                    <p class="text-muted">Tiempo Espera</p>
                </div>

                <div class="col-md-6">
                    <h3>{{ mainCtrl.items.results.wb | number:8}}</h3>
                    <p class="text-muted">Tiempo Permanencia</p>
                </div>
            </div>
        </div>

        <div class="col-sm-4 text-center">
            <h2 class="section-heading text-primary">Total </h2>

            <div class="service-box">
                <h3>{{ mainCtrl.items.results.acustomers + mainCtrl.items.results.bcustomers}}</h3>
                <p class="text-muted">Total Customers</p>
            </div>

            <div class="service-box">
                <div class="progress">
                    <div class="progress-bar progress-bar-success" style="width:{{mainCtrl.items.results.h | percentage:3}}">
                        {{mainCtrl.items.results.h | percentage:3}}
                    </div>
                </div>
                <p class="text-muted">Porcentaje Atencion</p>
            </div>

            <div class="service-box">
                <div class="col-md-6">
                    <h3>{{ mainCtrl.items.results.lc | number:8}}</h3>
                    <p class="text-muted">Longitud Cola</p>
                </div>

                <div class="col-md-6">
                    <h3>{{ mainCtrl.items.results.l | number:8}}</h3>
                    <p class="text-muted">Longitud Sistema</p>
                </div>
            </div>

            <div class="service-box">
                <div class="col-md-6">
                    <h3>{{ mainCtrl.items.results.wc | number:8}}</h3>
                    <p class="text-muted">Tiempo Espera</p>
                </div>

                <div class="col-md-6">
                    <h3>{{ mainCtrl.items.results.w | number:8}}</h3>
                    <p class="text-muted">Tiempo Permanencia</p>
                </div>
            </div>


        </div>


    </div>

    <div ng-show="mainCtrl.formData.simData.withEvents">
        <div class="row">
            <flot dataset="mainCtrl.chartData" options="mainCtrl.myChartOptions" height="300px" width="100%"></flot>
        </div>

        <div class="row">
            <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample"> View Events</button>
            <div class="collapse" id="collapseExample">
                <!--<pre>{{mainCtrl.items.events | json}}</pre>-->
                <table class="table table-condensed table-hover">
                    <thead>
                    <tr>
                        <th>t</th>
                        <th>Event</th>
                        <th>Client Type</th>
                        <th>Client Number</th>
                        <th>Queue Size</th>
                        <th>Status</th>
                        <th>W</th>
                        <th>Wc</th>
                        <th>Comment</th>
                        <th>deltaTime</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="event in mainCtrl.items.events">
                        <td>{{event.initTime}}</td>
                        <td>{{event.type}}</td>
                        <td>{{event.customer.type}}</td>
                        <td>{{event.customer.customerNumber}}</td>
                        <td>{{event.queueLength}}</td>
                        <td>{{event.attentionChanelStatus}}</td>
                        <td>{{event.type == 'DEPARTURE' ? event.customer.permanence : ""}}</td>
                        <td>{{event.type == 'DEPARTURE' ? event.customer.waitTime : ""}}</td>
                        <td>{{event.comment}}</td>
                        <td>{{event.deltaTime}}</td>
                    </tr>

                    </tbody>
                </table>

            </div>
        </div>
    </div>
</div>
